# 2019.03.07



## 챗봇을 이용해 날씨 구간별 입을 의상 추천해주기



### 기획 동기

- 오늘은 어떤 부분을 다뤄볼까 고민을 하던 와중에 온도가 자주 변하는 환절기에는 어떤 옷을 입어야할 지 고민이라는 여자친구의 얘기를 듣고 구상하게 되었다.
- ### 이전에 telegram과 카카오톡 챗봇을 통해 '날씨' 키워드를 입력했을 때 자신의 위치 기준 주변 날씨를 반환하는 기능을 구현한 적이 있다.
- 그런데 예를 들어 기온이 7도라고 하면 사실 추운지 따뜻한지 가늠하기가 힘들다. 그래서 얇은 가디건이 어울리는 날씨인지, 외투를 입고 가야 하는 날씨인지를 함께 제공해주면 더 편리해질 것 같다는 생각이 들었다.



### 구현 방법

- 네이버에 '온도별 옷차림'을 검색해보니 많은 정보들이 나왔다. 이 정보들을 바탕으로 날씨를 몇 개의 구간으로 나눈 다음, 해당 구간에 어울리는 옷들로 리스트를 구성한다.

> 예시)
>
> 0도 ~ 10도 => [패딩, 맨투맨, 니트]
>
> 10도 ~ 15도 => [코트, 셔츠, 맨투맨]
>
> 15도 ~ 20도 => [얇은 외투, 가디건, 셔츠]
>
> 20도 ~ 30도 => [반팔, 얇은 옷]
>
> 30도 이상 => [외출을 자제하세요]

- 기존의 온도 정보를 가져와 int 타입의 변수로 변환한 다음, if 문을 이용해 구간 필터링을 적용한다.
- 구간을 정했다면 해당 리스트에서 random.choice를 이용해 리스트 내부에서 임의의 원소를 가져온다.
- 구성된 정보를 보기 좋게 가공하여 챗봇으로 전송한다.

> 답변 예시)
>
> [해당 지역]의 현재 기온은 n도 입니다. 최저 기온과 최고 기온은 각각 n도, n도 입니다.
>
> 오늘은 [옷 추천]을 입고 나가보시는 게 어떨까요?

- 안타깝게도 노트북이 윈도우즈 업데이트 때문에 3시간이 넘게 먹통이 되어버렸다. 상세한 구현부는 노트북이 살아나는 대로 진행할 예정이다.



## dict 프로젝트, 과연 문제점은?



### 문제 분석

- 이전에 챗봇에 사전 검색을 추가하려고 했을 때 계속해서 null list가 출력되는 문제가 있었다. '네이버 사전 크롤링'이라는 표제어로 검색했을 때 hoonhoons라는 유저가 작성한 영한 사전 크롤러 프로그램을 발견했다.

- url에 input을 통해 입력받은 word 변수를 추가하여 requests.get()로 전송하는 방식은 동일했다.

- 그러나 이를 BeautifulSoup을 이용해 파싱할 때 html이 아닌 lxml로 하는 방식에 차이가 있었다.

- 마찬가지로 soup 객체에서 select가 아닌 find 함수를 사용한 것도 달랐다. 그러나 find와 select는 표현하는 방식의 차이이지, 크롤링 자체가 되지 않는 현재 상황의 원인이라고 보기는 힘들다.

### html과 lxml

- lxml은 파서의 일종이다. 기본적으로 내가 사용하고 있던 html보다 속도가 빠르다는 장점이 있다고 한다.
- 그런데 lxml은 외부 프로그램이기 때문에 여타 패키지처럼 설치해주어야 한다는 단점은 있다.
- 그런데 html 파서를 사용하든 lxml을 사용하든 만들어진 soup객체에서 css selector를 이용한다는 점에는 차이가 없다! 그렇다면 이것도 원인이 아니라는 뜻일까?
- iframe을 이용한 문서인가 의심도 해보았지만, 페이지 검사로 확인해보았을 때는 그것도 아니었다.

### 정리

- 오늘도 원인을 찾아내지 못했다. 간단한 크롤링이라고 생각했는데 생각 외로 잘 풀리지 않아 답답하다. 다시 코드를 실행시켜 확인해보고 싶지만 여자친구 노트북으로 작성하고 있는 상황이라 쉽지 않다. 문제 점검은 내일도 이어나갈 것이다.

  